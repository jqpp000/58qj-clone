<% 
  const pageContent = `
    <div class="admin-header">
      <h1>广告管理</h1>
      <a href="/admin/ads/add" class="btn btn-primary">
        <i class="fa fa-plus"></i> 添加新广告
      </a>
    </div>

    <div class="admin-content">
      <% positions.forEach(position => { %>
        <div class="panel" style="border-color: <%= position.style.borderColor %>; margin-bottom: 20px;">
          <div class="panel-header" style="
                background-color: <%= position.style.titleBgColor %>;
                color: <%= position.style.titleColor %>;
                border-bottom: 1px solid <%= position.style.borderColor %>;">
            <%= position.name %>
          </div>
          <div class="panel-body" style="background-color: <%= position.style.backgroundColor %>;">
            <% const ads = adsByPosition[position._id] || []; %>
            <% if (ads.length > 0) { %>
              <table class="data-table">
                <thead>
                  <tr>
                    <th>标题</th>
                    <th>图片</th>
                    <th>排序</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody>
                  <% ads.forEach(ad => { %>
                    <tr>
                      <td><%= ad.title %></td>
                      <td><img src="<%= ad.imageUrl %>" class="thumbnail"></td>
                      <td><%= ad.sort %></td>
                      <td>
                        <a href="/admin/ads/delete/<%= ad._id %>" class="btn btn-danger btn-sm"
                           onclick="return confirm('确定要删除这个广告吗？')">
                          <i class="fa fa-trash"></i> 删除
                        </a>
                      </td>
                    </tr>
                  <% }) %>
                </tbody>
              </table>
            <% } else { %>
              <div class="empty-state">
                <p>该位置暂无广告</p>
                <a href="/admin/ads/add" class="btn btn-secondary">添加广告</a>
              </div>
            <% } %>
          </div>
        </div>
      <% }) %>
    </div>
  `;
%>

<!-- 引入后台布局 -->
<%- include('../layouts/admin-main', { 
  title: '广告管理 - 58信息网后台',
  content: pageContent
}) %>
